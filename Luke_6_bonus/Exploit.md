# Bonus Flag Exploit Analysis

After reviewing the code, I searched for a second-stage bug that would allow adding "santa" or "toy-maker" to `elf.roles` (or otherwise reach `present_server`) via localhost (port 8000), but did not find one.

The only path to the bonus flag is `POST /api/workshop/present` in `app.js` (line 180), which always forwards roles loaded from the local SQLite roles table (`utils.js`). These roles cannot be controlled through the request.

There is no API endpoint that can add roles beyond the hardcoded "elf" and "intern" in `app.js` (line 100).

The registration mass-assignment bug (`createElf(req.body)` in `app.js` line 95) only allows setting `verified` (so you can get FLAG via `/api/workshop/notices`), but does not allow minting new rows in `elf_roles` or changing role names.

`presentname` is used with a parameterized query in `server.js` (line 31), so there is no SQL injection to rewrite the present table through that endpoint.

Unless there is something outside these files (e.g., an exposed Docker socket, another service/port, existing DB data with a privileged elf, or an RCE in the running environment), `FLAG_BONUS` is not extractable via localhost (port 8000) alone.

If you want, I can also audit the built images’ runtime configuration (user, filesystem permissions, mounted volumes, etc.) to see if there’s an escape or pivot path.